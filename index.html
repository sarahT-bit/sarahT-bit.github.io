
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Code Editor with Line Numbers & Var Hints</title>
  <style>
    .code-editor-container {
      position: relative;
      font-family: monospace;
      border: 1px solid #ccc;
      border-radius: 6px;
      display: flex;
      width: 100%;
      height: 300px;
      overflow: hidden;
    }
    .line-numbers {
      background: #f0f0f0;
      padding: 8px 4px;
      text-align: right;
      user-select: none;
      color: #666;
      border-right: 1px solid #ccc;
      overflow: hidden;
    }
    .line-numbers div {
      height: 1.2em; /* match line height in editor */
    }
    .code-editor {
      flex: 1;
      padding: 8px;
      outline: none;
      overflow: auto;
      white-space: pre;
      line-height: 1.2em;
      font-size: 14px;
    }
    .hint-box {
      margin-top: 4px;
      font-size: 12px;
      color: #888;
      font-style: italic;
    }
  </style>
</head>
<body>
  <div class="code-editor-container">
    <div class="line-numbers" id="lineNumbers">
      <div>1</div>
    </div>
    <div class="code-editor" contenteditable="true" id="codeEditor" spellcheck="false"></div>
  </div>
  <div class="hint-box" id="hintBox"></div>

  <script>
    const codeEditor = document.getElementById('codeEditor');
    const lineNumbersEl = document.getElementById('lineNumbers');
    const hintBox = document.getElementById('hintBox');

    function updateLineNumbers() {
      const text = codeEditor.innerText || '';
      const lines = text.split('\n');
      const count = lines.length;
      // remove all existing and re-add
      lineNumbersEl.innerHTML = '';
      for (let i = 1; i <= count; i++) {
        const lineDiv = document.createElement('div');
        lineDiv.textContent = i;
        lineNumbersEl.appendChild(lineDiv);
      }
    }

    function getVariableHints(text) {
      // rudimentary: find variable declarations like "var x", "let y", "const z"
      const varNames = new Set();
      const varDeclPattern = /\b(?:var|let|const)\s+([a-zA-Z_$][0-9a-zA-Z_$]*)/g;
      let match;
      while ((match = varDeclPattern.exec(text)) !== null) {
        varNames.add(match[1]);
      }
      return Array.from(varNames);
    }

    function showHints() {
      const text = codeEditor.innerText || '';
      const vars = getVariableHints(text);
      const cursorText = getTextBeforeCursor();
      // find last word being typed
      const wordMatch = cursorText.match(/([a-zA-Z_$][0-9a-zA-Z_$]*)$/);
      if (wordMatch) {
        const prefix = wordMatch[1];
        const suggestions = vars.filter(v => v.startsWith(prefix) && v !== prefix);
        if (suggestions.length > 0) {
          hintBox.textContent = 'Did you mean: ' + suggestions.join(', ');
        } else {
          hintBox.textContent = '';
        }
      } else {
        hintBox.textContent = '';
      }
    }

    function getTextBeforeCursor() {
      const sel = window.getSelection();
      if (!sel || sel.rangeCount === 0) return '';
      const range = sel.getRangeAt(0).cloneRange();
      range.selectNodeContents(codeEditor);
      range.setEnd(sel.anchorNode, sel.anchorOffset);
      return range.toString();
    }

    codeEditor.addEventListener('input', () => {
      updateLineNumbers();
      showHints();
    });

    codeEditor.addEventListener('scroll', () => {
      // sync scroll of line numbers
      lineNumbersEl.scrollTop = codeEditor.scrollTop;
    });

    // Initialize
    updateLineNumbers();
  </script>
</body>
</html>












