<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CS Tutoring Platform</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
    }

    #app {
      padding: 20px;
    }

    .hidden {
      display: none;
    }

    .flex-row {
      display: flex;
      gap: 20px;
    }

    .column {
      flex: 1;
    }

    textarea, select, input, button {
      display: block;
      margin-bottom: 10px;
      width: 100%;
    }

    #chat-messages {
      height: 200px;
      overflow-y: auto;
      border: 1px solid #ccc;
      padding: 5px;
      background: #f9f9f9;
    }

    #video {
      height: 200px;
      background: #ddd;
      display: flex;
      justify-content: center;
      align-items: center;
      margin-bottom: 10px;
    }

    #whiteboard {
      border: 1px solid black;
      display: block;
    }

    #code-editor {
      height: 200px;
      border: 1px solid #ccc;
    }
  </style>
</head>
<body>

<div id="app">
  <!-- Step 1: Selection Page -->
  <div id="selection-page">
    <h1>CS Tutoring Platform</h1>

    <label for="topic">Select Topic:</label>
    <select id="topic">
      <option value="">-- Choose a Topic --</option>
      <option>Data Structures</option>
      <option>Discrete Structures</option>
      <option>Intro to Theory Comp.</option>
    </select>

    <label for="language">Select Programming Language:</label>
    <select id="language">
      <option value="">-- Choose a Language --</option>
      <option>Python</option>
      <option>JavaScript</option>
      <option>C++</option>
      <option>Java</option>
    </select>

    <label for="problem">Describe Your Problem:</label>
    <textarea id="problem" rows="4" placeholder="Type your issue here..."></textarea>

    <button onclick="submitForm()">Get Help</button>
  </div>

  <!-- Step 2: Loading Screen -->
  <div id="loading-page" class="hidden">
    <h2>Linking you to a tutor...</h2>
  </div>

  <!-- Step 3: Live Session -->
  <div id="session-page" class="hidden">
    <h2>Live Tutoring Session</h2>
    <div class="flex-row">
      <!-- Left Panel -->
      <div class="column">
        <h4>Text Editor</h4>
        <textarea rows="5" placeholder="Take notes here..."></textarea>

        <h4>Code Editor</h4>
        <div id="code-editor"></div>
        <button onclick="checkCode()">Check Code</button>

        <h4>Whiteboard</h4>
        <canvas id="whiteboard"></canvas>
      </div>

      <!-- Right Panel -->
      <div class="column" style="max-width: 300px;">
        <div id="video"><p>[Tutor Video Here]</p></div>

        <h4>Chat</h4>
        <div id="chat-messages"></div>
        <input id="chat-input" placeholder="Type a message...">
        <button onclick="sendMessage()">Send</button>
      </div>
    </div>
  </div>
</div>

<!-- Monaco Editor -->
<script src="https://unpkg.com/monaco-editor@0.34.1/min/vs/loader.js"></script>

<!-- Fabric.js for Whiteboard -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/4.6.0/fabric.min.js"></script>

<script>
  const selectionPage = document.getElementById("selection-page");
  const loadingPage = document.getElementById("loading-page");
  const sessionPage = document.getElementById("session-page");
  const chatMessages = document.getElementById("chat-messages");
  const chatInput = document.getElementById("chat-input");

  let editor;
  let canvas;

  function submitForm() {
    const topic = document.getElementById("topic").value;
    const language = document.getElementById("language").value;
    const problem = document.getElementById("problem").value;

    if (!topic || !problem) {
      alert("Please select a topic and describe your problem.");
      return;
    }

    selectionPage.classList.add("hidden");
    loadingPage.classList.remove("hidden");

    setTimeout(() => {
      loadingPage.classList.add("hidden");
      sessionPage.classList.remove("hidden");

      // Wait for DOM to layout before initializing tools
      setTimeout(() => {
        initializeMonaco(language);
        initializeWhiteboard();
      }, 100);
    }, 2000); // Simulate tutor linking
  }

  function initializeMonaco(language) {
    const lang = (language || "javascript").toLowerCase();

    require.config({ paths: { vs: "https://unpkg.com/monaco-editor@0.34.1/min/vs" }});
    require(["vs/editor/editor.main"], function () {
      editor = monaco.editor.create(document.getElementById("code-editor"), {
        value: "// Start coding here...",
        language: lang,
        theme: "vs-dark",
        automaticLayout: true
      });
    });
  }

  function initializeWhiteboard() {
    const canvasElement = document.getElementById("whiteboard");

    const rect = canvasElement.getBoundingClientRect();
    canvasElement.width = rect.width;
    canvasElement.height = 200;

    canvas = new fabric.Canvas("whiteboard", {
      isDrawingMode: true
    });

    canvas.freeDrawingBrush.color = "black";
    canvas.freeDrawingBrush.width = 3;
  }

  function sendMessage() {
    const msg = chatInput.value.trim();
    if (!msg) return;

    appendMessage("You", msg);
    chatInput.value = "";

    // Simulated tutor reply
    setTimeout(() => {
      appendMessage("Tutor", "Thanks! Let me take a look.");
    }, 1000);
  }

  function appendMessage(sender, text) {
    const msgElem = document.createElement("div");
    msgElem.innerHTML = `<b>${sender}:</b> ${text}`;
    chatMessages.appendChild(msgElem);
    chatMessages.scrollTop = chatMessages.scrollHeight;
  }

  function checkCode() {
    if (!editor) {
      alert("Editor not ready yet.");
      return;
    }

    const code = editor.getValue();
    console.log("User's Code:", code);

    // Simple placeholder logic — You could later run linting, use an API, etc.
    if (code.includes("error")) {
      alert("⚠️ Found 'error' in your code. Please check.");
    } else {
      alert("✅ Code looks good!");
    }
  }
</script>

</body>
</html>












